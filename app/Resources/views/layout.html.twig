
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}UVweb{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Alexandre Masciulli - Thomas Keunebroek - Maxime">

    <!-- Le styles -->
    <style type="text/css">
      body {
      padding-top: 60px;
      padding-bottom: 40px;
    }
    .table thead tr.success th {
        background-color: #d6e9c6;
    }
    .table thead tr.error th {
        background-color: #eed3d7;
    }
    </style>
    
    {% block stylesheets %}
      <link rel="stylesheet" href="{{ asset('css/bootstrap.css') }}" type="text/css" />
    {% endblock %}

<script src="https://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
      <link rel="shortcut icon" href="{{ asset('img/favicon.png') }}">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
             
          <a class="brand" href="{{ path('uvweb_uv_homepage') }}"><img src="{{ asset('img/uvweb_logo.png') }}"></a>
          <div class="nav-collapse collapse navbar-responsive-collapse">
            <ul class="nav pull-right">
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                  UVs
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                  <li class="nav-header">Branche</li>
                  <li><a href="#">GB</a></li>
                  <li><a href="#">GI</a></li>
                  <li><a href="#">GM</a></li>
                  <li><a href="#">GP</a></li>
                  <li><a href="#">GSM</a></li>
                  <li><a href="#">GSU</a></li>
                  <li class="nav-header">Communes</li>
                  <li><a href="#">TC</a></li>
                  <li><a href="#">TSH</a></li>
                  <li class="nav-header">Toutes</li>
                  <li><a href="#">Ordre Alphabétique</a></li>
                  <li><a href="#">Notes Étudiants</a></li>
                </ul>
              </li>
              <li style="height: 49px;" class="divider-vertical"></li>
              <li class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                  <i class="icon-user icon-white"></i> 
                  {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                    <span>{{ app.user.identity }}</span>
                  {% else %}
                    <span>Non connecté</span>
                  {% endif %}
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                  {% if app.user is not null %}
                    <li class="{% if userView is defined %}active{% endif %}"><a href="{{  path('uvweb_uv_profile' , { 'userid': app.user.id }) }}"><i class="icon-home"></i> Profil</a></li>

                    {% if is_granted('ROLE_ADMIN') %}
                      <li class="{% if adminView is defined %}active{% endif %}"><a href="{{  path('uvweb_admin_home') }}"><i class="icon-star"></i> Modération</a></li>
                    {% endif %}
                      <li class="divider"></li>

                    <li><a href="{{ path('uvweb_logout') }}"><i class="icon-off"></i> Déconnexion</a></li>
                  {% else %}
                    <li><a href="{{  path('uvweb_login') }}">Connexion (CAS UTC)</a></li>
                  {% endif %}
                </ul>
            </li>
          </ul>

          <form id="search-uv-form" class="form-search navbar-search pull-right" method="GET" action="{{ path('uvweb_uv_detail') }}" style="margin-right: 15px;">
            <div class="input-append">
              <input style="width: 120px;" name="uvname" autocomplete="off" id="search-uv-name" class="search-query span2" type="text" placeholder="Rechercher une UV">
              <button type="submit" class="btn btn-primary">
                <i class="icon-search icon-white"></i>
              </button>
            </div>
          </form>


 {#           {% if searchbar is defined %}
          <form class="navbar-search pull-right" method='POST' {{ form_enctype(searchbar) }}>
              {% form_theme searchbar 'UvwebUvBundle::searchbar.html.twig' %}
              {{ form_widget(searchbar) }}
            <span class="icon-search">
<!--               <button type="submit" class="icon nav-search" tabindex="-1">
                <span class="visuallyhidden">
                </span>
              </button> -->
            </span>
          </form>
            {% endif %} #}
          </div>
        </div>
      </div>
    </div>

    <div class="container">

      <div id="ajax-message">
        {% if app.session.flashbag.has('message_to_display') %}
          {% set message = app.session.flashbag.get('message_to_display')[0] %}
          {% include 'UvwebUvBundle:Common:message-info.html.twig' with { 'message': message } %}
        {% endif %}
      </div>

      <div class="row-fluid">
        {% block body %}
        {% endblock %}

        <hr>

        <footer>
          <p>&copy; <a href="http://masciulli.fr">Alexandre Masciulli</a> - <a href="http://thomaskeunebroek.fr">Thomas Keunebroek</a> - <a href="#">Maxime</a> 2013</p>
        </footer>
      </div>
    </div>

  <!-- Le javascript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
<script type="text/javascript" language="javascript"
  src="{{ asset('js/bootstrap.min.js') }}"></script>

<script type="text/javascript" language="javascript">
$(function() {

  //Function used to show UV names to the user when he is typing
  $('#search-uv-name').typeahead({
    //Fetching the matching UV names
    source: function(query, process) {
      return $.ajax({
        url: '{{ path('uvweb_uv_nameslike') }}',
        type: 'GET',
        data: {
          uvLike: query,
          limit: 10
        },
        dataType: 'json',
        success: function (result) {
                  return process(result);
        }
      });
    },
    //On click on a tab, the user is redirected to the UV
    updater: function (item) {
      document.location = '{{ path('uvweb_uv_detail') }}' + '/' +encodeURIComponent(item);
      return item;
    }
  });

});
</script>

{% block js %}{% endblock %}
  </body>
</html>
